# HEVC编码视频显示问题解决方案

## 🔍 问题诊断

您的RTSP流使用HEVC/H265编码，但大多数浏览器**不支持HEVC编码**的WebRTC视频流，这是视频无法显示的根本原因。

## ✅ 已实施的解决方案

### 1. 新的HEVC兼容服务器
- **文件**: `scripts/webrtc/hevc_compat_server.py`
- **端口**: 8090
- **功能**: 实时将HEVC转换为H264兼容格式
- **状态**: ✅ 已启动并运行正常

### 2. 服务状态确认
```bash
# WebRTC服务器:  ✅ 运行中 (端口8090)
# API服务器:     ✅ 运行中 (端口8004)  
# 前端服务器:    ✅ 运行中 (端口5173)
```

## 🎯 立即测试步骤

### 方法1: 使用测试页面（推荐）
1. 打开浏览器访问: `http://localhost:5173/test_webrtc.html`
2. 点击"检查所有服务"确认状态
3. 选择预设设备或输入RTSP地址
4. 点击"启动WebRTC"测试视频

### 方法2: 直接访问监控系统
1. 打开: `http://localhost:5173`
2. 选择任一设备查看实时视频

## 📋 RTSP地址格式

**当前设备配置:**
- **录像机一**: `rtsp://admin:Chang168@192.168.42.85:55401/Streaming/Channels/101`
- **录像机二**: `rtsp://admin:Chang168@192.168.42.86:55401/Streaming/Channels/101`

## 🔧 技术细节

### 问题根源
- **原始编码**: HEVC/H265
- **浏览器支持**: ❌ 大多数浏览器不支持HEVC
- **解决方案**: ✅ 实时转码为H264

### 转码流程
```
HEVC RTSP流 → OpenCV捕获 → RGB转换 → H264编码 → WebRTC传输 → 浏览器显示
```

## 🚨 故障排除

### 如果仍然无法显示
1. **检查网络**: 确保设备IP可达
2. **验证RTSP**: 使用VLC测试RTSP流
3. **查看日志**: 检查终端输出
4. **重启服务**: 
   ```bash
   python scripts\webrtc\hevc_compat_server.py --host 0.0.0.0 --port 8090
   ```

### 常见问题
- **黑屏**: 等待5-10秒，HEVC转码需要时间
- **连接超时**: 检查防火墙设置
- **解码错误**: 确认摄像头编码格式

## ✅ 预期结果

完成上述步骤后，您应该能够在浏览器中看到实时视频流，所有设备都应该正常工作。

**测试成功指标:**
- ✅ 测试页面显示视频
- ✅ 监控系统正常播放
- ✅ 无HEVC相关错误

现在请访问测试页面验证修复效果！