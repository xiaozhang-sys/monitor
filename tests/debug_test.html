
<!DOCTYPE html>
<html>
<head>
    <title>监控测试页面</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .video-container { width: 640px; height: 480px; border: 1px solid #ccc; margin: 10px; }
        .log { background: #f0f0f0; padding: 10px; margin: 10px 0; font-family: monospace; }
        button { padding: 10px 20px; margin: 5px; }
    </style>
</head>
<body>
    <h1>监控黑屏调试</h1>
    
    <h2>测试1: 静态测试视频</h2>
    <video id="test-video" controls autoplay style="width: 640px; height: 360px;">
        <source src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
    </video>
    
    <h2>测试2: 直接RTSP流</h2>
    <div id="webrtc-container" class="video-container"></div>
    
    <div class="log" id="log"></div>
    
    <button onclick="testConnection()">测试连接</button>
    <button onclick="clearLog()">清除日志</button>
    
    <script>
        const log = document.getElementById('log');
        
        function addLog(message) {
            log.innerHTML += new Date().toLocaleTimeString() + ': ' + message + '<br>';
            log.scrollTop = log.scrollHeight;
        }
        
        function testConnection() {
            addLog('开始测试连接...');
            
            // 测试WebRTC服务
            fetch('http://localhost:8090/health')
                .then(res => res.json())
                .then(data => addLog('WebRTC服务: ' + JSON.stringify(data)))
                .catch(err => addLog('WebRTC错误: ' + err));
                
            // 测试后端服务
            fetch('http://localhost:8003/devices')
                .then(res => res.json())
                .then(data => addLog('后端设备: ' + data.length + ' 个'))
                .catch(err => addLog('后端错误: ' + err));
        }
        
        function clearLog() {
            log.innerHTML = '';
        }
        
        // 页面加载时自动测试
        window.onload = function() {
            addLog('页面加载完成');
            testConnection();
        };
    </script>
</body>
</html>
        